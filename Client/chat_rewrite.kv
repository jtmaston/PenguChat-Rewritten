ScreenManager:
	transition: RiseInTransition()
	LoginScreen:
	    name:'loading_screen'
	    Image:
	        size: self.size
	        pos: self.pos
	        source: "Assets/Loading.gif"

    LoginScreen:
		name: 'login_failed'
		BoxLayout:
			orientation: 'vertical'
			padding: 10
	        spacing: 10
			Label:
			    size_hint_y: 0.2
                canvas.before:
                    Color:
                        rgba: 1, 0, 0, 1
                    Rectangle:
                        pos: self.pos
                        size: self.size
                text: "Username or password incorrect!"
			LoginGridLayout:
				LoginLabel:
					text: 'Username:'

				TextInput:
					id: loginUsr_failed
					write_tab: False
					multiline: False

				LoginLabel:
					text: 'Password'

				TextInput:
					id: loginPass_failed
					password: True
					write_tab: False
					multiline: False
					on_text_validate: app.send_login_data()

			BlueButton:
				color: 0, 0, 0, 1
				text: 'Connect'
				on_press: app.send_login_data()
			BlueButton:
				text: 'Sign up'
				color: 0, 0, 0, 1
				on_press: app.root.current = 'signup'

	LoginScreen:
		name: 'a'
		BoxLayout:
		    padding: 10
	        spacing: 10
			orientation: 'vertical'
			LoginGridLayout:
				LoginLabel:
					text: 'Username:'

				TextInput:
					id: loginUsr
					write_tab: False
					multiline: False
					text: 'alexey'

				LoginLabel:
					text: 'Password'

				TextInput:
					id: loginPass
					password: True
					write_tab: False
					text: 'DatBoi30'
					multiline: False
					on_text_validate:
					    app.send_login_data()

			BlueButton:
				color: 0, 0, 0, 1
				text: 'Connect'
				on_press: app.send_login_data()
			BlueButton:
				text: 'Sign up'
				color: 0, 0, 0, 1
				on_press: app.root.current = 'signup'
	LoginScreen:
		name: 'signup_fail'
		BoxLayout:
		    padding: 10
	        spacing: 10
			orientation: 'vertical'
			Label:
			    size_hint_y: 0.2
                canvas.before:
                    Color:
                        rgba: 1, 0, 0, 1
                    Rectangle:
                        pos: self.pos
                        size: self.size
                text: "That username is taken!"
			LoginGridLayout:
				LoginLabel:
					text: 'Username:'

				TextInput:
					id: username_fail
					write_tab: False
					multiline: False

				LoginLabel:
					text: 'Password'

				TextInput:
					id: passwd_fail
					password: True
					write_tab: False
					multiline: False

				LoginLabel:
					text: 'Password (again)'

				TextInput:
					id: passwd_r_fail
					password: True
					write_tab: False
					multiline: False
					on_text_validate: app.send_sign_up_data()

			BlueButton:
				text: 'Login'
				color: 0,0,0,1
				on_press: app.root.current = "login"

			BlueButton:
				text: 'Sign up'
				color: 0,0,0,1
				on_press: app.send_sign_up_data()           # TODO: CHECK! May be bad!

	LoginScreen:
		name: 'signup'
		BoxLayout:
            padding: 10
	        spacing: 10
			orientation: 'vertical'
			LoginGridLayout:
				LoginLabel:
					text: 'Username:'

				TextInput:
					id: username
					write_tab: False
					multiline: False

				LoginLabel:
					text: 'Password'

				TextInput:
					id: passwd
					password: True
					write_tab: False
					multiline: False

				LoginLabel:
					text: 'Password (again)'

				TextInput:
					id: passwd_r
					password: True
					write_tab: False
					multiline: False
					on_text_validate:
					    app.send_sign_up_data()

            BlueButton:
				text: 'Login'
				color: 0,0,0,1
				on_press: app.root.current = "login"

			BlueButton:
				text: 'Sign up'
				color: 0,0,0,1
				on_press: app.send_sign_up_data()


	Screen:
		on_enter:
			Window.size = (1080, 720)
			app.init_chat_room()
		name: 'chat_room'
		BoxLayout:
		    orientation: 'vertical'
		    BackgroundContainer:
		        padding: (0, 4, 0, 0)
                id: top_bar
                height: 60
                orientation: 'horizontal'
                size_hint: (1, None)
                spacing: 0

                MenuButton:
                    id: request_button
                    size_hint_x: 0.2

                MenuButton:
                    text: 'Logout'
                    size_hint_x: 0.2
                    on_press: app.logout()
                MenuButton:
                    text: 'Start a new chat!'
                    on_press: app.new_chat()


            BackgroundContainer:
                orientation: 'horizontal'
                padding: 5
                spacing: 5
                ScrollView:
                    size_hint_x: 0.3
	                ListGridLayout:
	                    id: sidebar

                BoxLayout:
                    padding: (1,0,0,0)
                    orientation: 'vertical'
                    canvas.before:
                        Color:
							rgba: 1, 1, 1, 1
						Rectangle:
							source:"assets/large-wallpaper.png"
							pos: self.pos
							size: self.size
					ScrollView:
						ListGridLayout:
							id: conversation

                    BoxLayout:
                        padding: 0
                        spacing: 0
                        id: message_box
                        height: 90
                        orientation: 'horizontal'
                        size_hint: (1, None)
                        TextInput:
                            canvas.before:
                                Color:
                                    rgba: 0, 0.213, 0.286, 1
                                Line:
                                    width: 2
                                    rectangle: self.x, self.y, self.width, self.height
                            id: message_content
                            on_text_validate: app.send()
                        MenuButton:
                            text: 'Send'
                            on_press: app.send()
                            size_hint: (0.3, 1)
                        MenuButton:
                            text: 'Attach file'
                            on_press: app.attach_file()
                            size_hint: (0.3, 1)
    LoginScreen:
		name: 'not_connected_screen'
		BoxLayout:
			orientation: 'vertical'
			Label:
			    size_hint_y: 0.2
                canvas.before:
                    Color:
                        rgba: 1, 0, 0, 1
                    Rectangle:
                        pos: self.pos
                        size: self.size
                text: "Not connected!"
			LoginGridLayout:
				LoginLabel:
					text: 'Username:'
				TextInput:
					disabled: True
				LoginLabel:
					text: 'Password'
				TextInput:
					disabled: True
			BlueButton:
				color: 0, 0, 0, 1
				text: 'Connect'
				disabled: True
			BlueButton:
				text: 'Sign up'
				color: 0, 0, 0, 1
				disabled: True